<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Promise.all</title>
    <style></style>
  </head>
  <body></body>
  <!-- 将多个Promise实例包装成一个新的实例返回，所有子实例均已决议后再返回决议结果，所有子实例均为fulfilled时新实例为fulfilled，任意一个子实例为rejected，新实例决议结果为rejected -->
  <script>
    Promise.myAll = (arr) => {
      return new Promise((resolve, reject) => {
        const promises = Array.from(arr);
        let count = 0;
        const r = [];
        const len = promises.length;
        for (let i = 0; i < len; i++) {
          Promise.resolve(promises[i])
            .then((v) => {
              r[i] = v;
              if (++count === len) {
                resolve(r);
              }
            })
            .catch((e) => {
              reject(e);
            });
        }
      });
    };
  </script>
</html>
